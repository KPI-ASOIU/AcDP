<%= form_tag tasks_path, :method => 'get', id: 'extendSearch' do %>
  <div class="col-md-3">
    <%= t('tasks.author') %>:
    <%= select_tag :author, options_for_select(
      [["Я", current_user.id], 
      ["Не я", Task.all.map { |t| t.author.id }.uniq.reject { |id| id == current_user.id }.join(" ")]].concat(current_user.executing_tasks.map { |t| [t.author.full_name, t.author.id] }.uniq)), 
      { class: "chosen-select", multiple: true, include_blank: true } %>
  </div>
  <div class="col-md-3">
    <%= t('tasks.executors') %>:
    <%= select_tag :executor, options_for_select(
      [["Я", current_user.id], 
      ["Не я", Task.all.map { |t| t.executors.pluck(:id) }.flatten.uniq
        .reject { |exec| exec == current_user.id }.join(" ")]]),
      { class: "chosen-select", multiple: true, include_blank: true } %>
  </div>
  <div class="col-md-3">
    <%= t('tasks.name') %>:
    <%= text_field_tag :name, nil, class: "form-control", placeholder: I18n.t('tasks.name') %>
  </div>
  <div class="col-md-3">
    <%= t('tasks.status') %>:
    <%= select_tag :status, options_for_select(Task::STATUS, []), { class: "chosen-select", multiple: true, include_blank: true } %>
  </div>
  <div class="col-md-6">
    <%= t('tasks.execution_date') %>:
    <div class='input-group'>
      <span class="input-group-addon">
        <%= t('util.from') %>
      </span>
      <%= text_field_tag :exec_start_date, nil, class: "form-control date", id: "datetimepicker1" %>
      <span class="input-group-addon">
        <%= t('util.to') %>
      </span>
      <%= text_field_tag :exec_end_date, nil, class: "form-control date", id: "datetimepicker2" %>
    </div>
  </div>
  <div class="col-md-6">
    <%= t('tasks.creation_date') %>:
    <div class='input-group'>
      <span class="input-group-addon">
        <%= t('util.from') %>
      </span>
      <%= text_field_tag :creation_start_date, nil, class: "form-control date", id: "datetimepicker3" %>
      <span class="input-group-addon">
        <%= t('util.to') %>
      </span>
      <%= text_field_tag :creation_end_date, nil, class: "form-control date", id: "datetimepicker4" %>
    </div>
  </div>
<% end %>
