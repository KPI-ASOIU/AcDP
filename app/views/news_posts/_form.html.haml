= render 'document_select'

.ui.attached.segment
  = form_for(@news_post, :html => { :class => 'form-horizontal', role: 'form' }) do |f|
    - if @news_post.errors.any?
      .news-errors-block{ class: 'news-errors-block' }
        %h2= t('activerecord.errors.template.header', count: @news_post.errors.count)
        %ul
          - @news_post.errors.full_messages.each do |msg|
            %li= msg
    .ui.grid
      .row
        .two.wide.column 
          = f.label :title
        .column 
          = f.text_field :title, :placeholder => t('news.ph_title'), :class => 'ui fluid input'
      .row
        .two.wide.column
          = f.label :content
        .column 
          = f.text_area :content, :placeholder => t('news.ph_content'), :class => '', :id => 'news_post_content'
      .row
        .two.wide.column
          = f.label :tags, :class=>''
        .column 
          = f.text_field :tags, :placeholder => t('news.ph_tags'), :class => 'ui fluid'
      .row
        .two.wide.column
          = label_tag :icon, t('activerecord.attributes.news_post.icon'), :class=>'ui fluid'
        .column 
          = f.file_field :icon
          = image_tag @news_post.icon.url('medium'), class: 'ui small image'
          - unless @news_post.new_record?
            = link_to t('util.destroy'), icon_news_post_path(@news_post), :method => :delete, :class => 'ui mini negative button'
      .row
        .two.wide.column
          = f.label :for_roles, :class=>'fluid'
        .column 
          = f.select :for_roles, options_for_select(post_roles, @news_post.category), {}, { class: 'form-control' }
          = select_tag :for_groups, options_for_select(Group.all.map { |g| [g.name, g.id] }, @news_post.groups.pluck(:id)), { class: 'chosen-select', multiple: true, include_blank: true, data: { placeholder: t('activerecord.models.group') + '...' } }
      .row
        .two.wide.column
          = label_tag :documents, t('news.attached_docs'), :class=>''
        .column 
          = f.hidden_field :documents, { :multiple => true }
          .ui.list{ id: 'news-attached-docs' }
            - unless @news_post.new_record?
              - @news_post.documents.each do |document|
                .item
                  = document.title
          =link_to '', id:'news-add-document-btn', data: { toggle: 'modal', target: '#modal_select_document' }, class: 'ui teal icon mini button' do
            %i{ class: 'attachment icon' }
            = t('news.add_doc')
    = button_tag type: 'submit', :class => 'ui right floated positive icon button' do
      %i{ class: 'bullhorn icon' }
      = t('news.publish')
    = link_to t('util.back'), news_posts_path, :class => 'ui negative right floated button'